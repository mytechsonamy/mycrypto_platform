# MyCrypto Platform - Development Environment Variables
# Copy this file to .env and fill in actual values
# NEVER commit .env to Git - it's in .gitignore

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Node environment (development, staging, production)
NODE_ENV=development

# Port where auth-service runs
PORT=3000

# Log level (trace, debug, info, warn, error, fatal)
LOG_LEVEL=debug

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =============================================================================

# PostgreSQL Connection String
# Format: postgresql://username:password@hostname:port/database
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/exchange_dev

# PostgreSQL connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=20
DATABASE_POOL_IDLE_TIMEOUT_MS=30000
DATABASE_POOL_CONNECTION_TIMEOUT_MS=2000

# Enable query logging (development only)
DATABASE_LOGGING=true

# =============================================================================
# REDIS CACHE CONFIGURATION
# =============================================================================

# Redis host and port
REDIS_HOST=localhost
REDIS_PORT=6379

# Redis password (empty for development without password)
REDIS_PASSWORD=redis_dev_password

# Redis database number (0-15)
REDIS_DB=0

# Redis connection settings
REDIS_RETRY_STRATEGY=1000,2000,3000,5000
REDIS_COMMAND_TIMEOUT_MS=5000

# Session TTL in seconds (24 hours)
SESSION_TTL=86400

# Cache TTL defaults
CACHE_TTL_SHORT=300        # 5 minutes
CACHE_TTL_MEDIUM=1800      # 30 minutes
CACHE_TTL_LONG=3600        # 1 hour

# =============================================================================
# RABBITMQ MESSAGE BROKER CONFIGURATION
# =============================================================================

# RabbitMQ connection URL
# Format: amqp://username:password@hostname:port
RABBITMQ_URL=amqp://rabbitmq:rabbitmq_dev_password@localhost:5672

# RabbitMQ virtual host
RABBITMQ_VHOST=/

# RabbitMQ connection settings
RABBITMQ_RECONNECT_DELAY_MS=5000
RABBITMQ_MAX_RECONNECT_ATTEMPTS=10

# Queue names
RABBITMQ_QUEUE_EMAIL_NOTIFICATIONS=email.notifications
RABBITMQ_QUEUE_SMS_NOTIFICATIONS=sms.notifications
RABBITMQ_QUEUE_KYC_PROCESSING=kyc.processing
RABBITMQ_QUEUE_AUDIT_LOGS=audit.logs

# Exchange names
RABBITMQ_EXCHANGE_AUTH_EVENTS=auth.events
RABBITMQ_EXCHANGE_USER_EVENTS=user.events

# =============================================================================
# JWT AUTHENTICATION - RSA Keys (RS256)
# =============================================================================

# JWT Algorithm: RS256 (RSA-based, asymmetric signing)
# CRITICAL: Use RSA-4096 keys for production
# Key generation:
#   openssl genrsa -out private.pem 4096
#   openssl rsa -in private.pem -pubout -out public.pem
# For production, store keys in AWS Secrets Manager or HashiCorp Vault
JWT_ALGORITHM=RS256
JWT_PRIVATE_KEY_PATH=/app/keys/private.pem
JWT_PUBLIC_KEY_PATH=/app/keys/public.pem

# JWT expiration times
JWT_ACCESS_TOKEN_EXPIRY=15m         # Access token expiry (15 minutes)
JWT_REFRESH_TOKEN_EXPIRY=30d        # Refresh token expiry (30 days)
JWT_EMAIL_VERIFICATION_EXPIRY=24h   # Email verification token expiry (24 hours)

# DEPRECATED - HS256 (kept only for backwards compatibility)
# DO NOT USE FOR NEW IMPLEMENTATIONS
# Use RSA keys (JWT_PRIVATE_KEY_PATH, JWT_PUBLIC_KEY_PATH) instead
JWT_SECRET=dev-jwt-secret-change-in-production-min-32-chars-here

# =============================================================================
# PASSWORD HASHING (bcrypt)
# =============================================================================

# bcrypt rounds (cost factor) - higher = more secure but slower
# Development: 10, Staging: 12, Production: 12+
BCRYPT_ROUNDS=10

# =============================================================================
# API CONFIGURATION
# =============================================================================

# API base URL
API_BASE_URL=http://localhost:3001
API_DOCS_URL=http://localhost:3001/api/docs
API_HEALTH_CHECK_URL=http://localhost:3001/health

# CORS configuration
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,http://localhost:5173

# Rate limiting
RATE_LIMIT_WINDOW_MS=60000           # 1 minute
RATE_LIMIT_MAX_REQUESTS=100          # 100 requests per window

# API request timeout
REQUEST_TIMEOUT_MS=30000

# =============================================================================
# EXTERNAL SERVICES (Third-party integrations)
# =============================================================================

# Email service configuration
# For development: use MailHog (MAIL_HOST=mailhog, MAIL_PORT=1025)
# For production: use AWS SES or Gmail SMTP
MAIL_HOST=mailhog
MAIL_PORT=1025
MAIL_USER=
MAIL_PASSWORD=
MAIL_FROM=noreply@exchange.local
MAIL_TEMPLATES_PATH=./templates/emails
MAIL_SMTP_SECURE=false
MAIL_SMTP_IGNORE_TLS=true

# Email service feature flags
EMAIL_VERIFICATION_ENABLED=true
EMAIL_VERIFICATION_TOKEN_EXPIRY=24h
EMAIL_VERIFICATION_MAX_RETRIES=3
EMAIL_NOTIFICATIONS_QUEUE=email.notifications

# Development email settings
MOCK_EMAIL_SERVICE=false
DEV_EMAIL_CAPTURE=true

# =============================================================================
# RECAPTCHA CONFIGURATION
# =============================================================================

# Google reCAPTCHA v3 keys
# Development: Use test keys provided below (always pass verification)
# Production: Generate keys from Google reCAPTCHA Admin Console
# https://www.google.com/recaptcha/admin/create
RECAPTCHA_SITE_KEY=6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI
RECAPTCHA_SECRET_KEY=6LeIxAcTAAAAAGG-vFI1TnRWxMZNFuojJ4WifJWe

# reCAPTCHA score threshold (0.0 to 1.0)
# Higher value = stricter bot detection
# Recommended: 0.5 for balanced security
# 0.9+ for high security but may block legitimate users
RECAPTCHA_SCORE_THRESHOLD=0.5

# SMS service (Twilio example)
TWILIO_ACCOUNT_SID=your-account-sid
TWILIO_AUTH_TOKEN=your-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# KYC service
KYC_API_URL=https://kyc-provider-api.example.com
KYC_API_KEY=your-kyc-api-key
KYC_WEBHOOK_SECRET=your-webhook-secret

# AML/Sanctions List service
SANCTIONS_LIST_API_URL=https://sanctions-api.example.com
SANCTIONS_LIST_API_KEY=your-api-key

# =============================================================================
# AWS CONFIGURATION (Production only)
# =============================================================================

# AWS region
AWS_REGION=eu-west-1

# AWS credentials (use IAM roles in production, not keys)
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key

# AWS S3 for document storage
AWS_S3_BUCKET=exchange-documents-dev
AWS_S3_REGION=eu-west-1

# AWS Secrets Manager
AWS_SECRETS_MANAGER_REGION=eu-west-1

# AWS SES for email
AWS_SES_REGION=eu-west-1

# =============================================================================
# S3 / MinIO CONFIGURATION (Object Storage for KYC Documents)
# =============================================================================

# S3 endpoint (MinIO for dev, AWS S3 for prod)
S3_ENDPOINT=http://minio:9000
S3_ENDPOINT_URL=http://localhost:9000

# S3 credentials
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin_password

# S3 bucket and region
S3_BUCKET_KYC=kyc-documents
S3_REGION=us-east-1

# S3 upload settings
S3_MAX_FILE_SIZE=52428800    # 50MB in bytes
S3_ALLOWED_MIME_TYPES=application/pdf,image/jpeg,image/png,image/webp

# S3 encryption
S3_SERVER_SIDE_ENCRYPTION=AES256
S3_ENCRYPTION_KEY=your-kms-key-id-for-production

# =============================================================================
# CLAMAV VIRUS SCANNING CONFIGURATION
# =============================================================================

# ClamAV daemon configuration
CLAMAV_HOST=clamav
CLAMAV_PORT=3310
CLAMAV_TIMEOUT=30000

# ClamAV feature flags
CLAMAV_ENABLED=true
CLAMAV_SCAN_ON_UPLOAD=true
CLAMAV_QUARANTINE_PATH=/quarantine

# =============================================================================
# BLOCKCHAIN INTEGRATION (Crypto Deposits/Withdrawals)
# =============================================================================

# BlockCypher API (Option A: MVP/Testnet)
BLOCKCYPHER_API_KEY=your-blockcypher-api-key
BLOCKCYPHER_WEBHOOK_URL=https://your-domain.com/api/v1/wallet/webhook/blockcypher
BLOCKCYPHER_TOKEN=your-blockcypher-token

# Supported networks for BlockCypher
BLOCKCYPHER_BTC_NETWORK=test3        # Bitcoin testnet (test3 or main for mainnet)
BLOCKCYPHER_ETH_NETWORK=ethtest      # Ethereum testnet (ethtest or ethereum for mainnet)
BLOCKCYPHER_USDT_NETWORK=ethtest     # USDT on Ethereum testnet

# Blockchain node configuration (Option B: Local nodes)
# Local Bitcoin Core node
BITCOIN_NODE_RPC_HOST=bitcoin
BITCOIN_NODE_RPC_PORT=18332
BITCOIN_NODE_RPC_USER=bitcoinrpc
BITCOIN_NODE_RPC_PASSWORD=your-bitcoin-rpc-password
BITCOIN_NETWORK=testnet              # testnet or mainnet

# Local Ethereum Geth node
ETH_NODE_RPC_URL=http://geth:8545
ETH_NETWORK_ID=5                     # 5 for Goerli testnet, 1 for mainnet
ETH_CHAIN_ID=5                       # 5 for Goerli, 1 for mainnet

# Crypto deposit/withdrawal settings
DEPOSIT_CONFIRMATION_BLOCKS=3        # Min blocks before marking deposit confirmed
WITHDRAWAL_FEE_PERCENTAGE=0.1        # 0.1% withdrawal fee
WITHDRAWAL_MIN_AMOUNT=0.001          # Minimum withdrawal amount in crypto
WITHDRAWAL_MAX_DAILY_LIMIT=10        # Max crypto withdrawal per day

# Blockchain scanning
BLOCKCHAIN_SCAN_INTERVAL=10000       # Scan for new blocks every 10 seconds
BLOCKCHAIN_CONFIRMATION_TIMEOUT=3600 # 1 hour timeout for pending deposits

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Session security
SESSION_SECRET=dev-session-secret-change-in-production-min-32-chars

# HTTPS enforcement
FORCE_HTTPS=false              # Development: false, Production: true

# HSTS (HTTP Strict Transport Security)
HSTS_MAX_AGE=31536000          # 1 year

# CSRF protection
CSRF_ENABLED=true

# Content Security Policy
CSP_ENABLED=true

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Prometheus metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Jaeger distributed tracing
JAEGER_ENABLED=false
JAEGER_ENDPOINT=http://localhost:14268/api/traces

# Application Performance Monitoring
APM_ENABLED=false
APM_SERVICE_NAME=auth-service

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Two-factor authentication (2FA)
FEATURE_2FA_ENABLED=true

# KYC verification
FEATURE_KYC_ENABLED=true

# Email verification
FEATURE_EMAIL_VERIFICATION=true

# Mobile app support
FEATURE_MOBILE_ENABLED=true

# =============================================================================
# ENVIRONMENT-SPECIFIC SETTINGS
# =============================================================================

# Mock external services (development only)
MOCK_EMAIL_SERVICE=false
MOCK_KYC_SERVICE=false
MOCK_SMS_SERVICE=false

# Seed database with test data
SEED_DATABASE=false

# Pretty print logs (development only)
PRETTY_LOGS=true

# =============================================================================
# HEALTH CHECK CONFIGURATION
# =============================================================================

# Health check endpoints
HEALTH_CHECK_DATABASE=true
HEALTH_CHECK_REDIS=true
HEALTH_CHECK_RABBITMQ=true

# Liveness probe timeout (seconds)
LIVENESS_PROBE_TIMEOUT=5

# Readiness probe timeout (seconds)
READINESS_PROBE_TIMEOUT=10

# =============================================================================
# MISCELLANEOUS
# =============================================================================

# Application version
APP_VERSION=1.0.0

# Build information
BUILD_ID=dev-build
BUILD_TIMESTAMP=$(date -u +'%Y-%m-%dT%H:%M:%SZ')

# Feature request ID for tracing
REQUEST_ID_HEADER=X-Request-ID

# Timezone for all timestamps
TZ=UTC
